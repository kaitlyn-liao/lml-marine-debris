import{s as n}from"./slicedToArray-c92cae3a.js";import{t as r}from"./toConsumableArray-25e5c43c.js";import{d as e}from"./defineProperty-9f9de5d0.js";import*as t from"react";import{f as o,a as i}from"./fromTreeToList-26486e10.js";import{u,a}from"./useSyncControlledState-80c86a40.js";var c=function(n,r){return n.every((function(n){return r.includes(n)}))};function l(n,r){var e=Object.keys(n);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(n);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable}))),e.push.apply(e,t)}return e}function d(n){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?l(Object(t),!0).forEach((function(r){e(n,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))}))}return n}var s=function(n,e){switch(e.type){case"ADD_BY_ID":return function(n,r){return d(d({},n),{},{id:null,ids:n.ids.concat(r.payload.id)})}(n,e);case"REMOVE_BY_ID":return function(n,r){return d(d({},n),{},{id:null,ids:n.ids.filter((function(n){return n!==r.payload.id}))})}(n,e);case"ADD_BY_ID_RECURSIVELY":return function(n,e){var t=e.payload.options.isCarryForward&&null!=n.id?r(Array.from(new Set(e.payload.ids.concat(n.id)))):n.ids.concat(e.payload.ids);return d(d({},n),{},{id:null,ids:t})}(n,e);case"REMOVE_BY_ID_RECURSIVELY":return function(n,r){return d(d({},n),{},{id:null,ids:n.ids.filter((function(n){return!r.payload.ids.includes(n)}))})}(n,e);case"ADD_BY_ID_EXCLUSIVELY":return function(n,r){return d(d({},n),{},{id:r.payload.id,ids:[]})}(n,e);case"REMOVE_BY_ID_EXCLUSIVELY":case"REMOVE_ALL":return function(n){return d(d({},n),{},{id:null,ids:[]})}(n);case"ADD_ALL":return function(n,e){return d(d({},n),{},{id:null,ids:r(Array.from(new Set([].concat(r(n.ids),r(e.payload.ids)))))})}(n,e);case"SET":return function(n,r){return d(d({},n),r.payload)}(n,e);default:throw new Error}},f={isCarryForward:!0,isPartialToAll:!1},y=function(n){return d(d({},f),n)},p=function(e,l,f,p){var I=u(s,l,[],[f],p),E=n(I,2),_=E[0],D=E[1],g=t.useRef({lastToggledId:null,currentShiftIds:[]}),v=!_.ids.length,b=!!e.nodes.length&&c(e.nodes.map((function(n){return n.id})),_.ids),m=t.useCallback((function(n){return D({type:"ADD_BY_ID",payload:{id:n}})}),[D]),A=t.useCallback((function(n){return D({type:"REMOVE_BY_ID",payload:{id:n}})}),[D]),C=t.useCallback((function(n){_.ids.includes(n)?A(n):m(n),g.current.lastToggledId=n,g.current.currentShiftIds=[]}),[_,m,A]),O=t.useCallback((function(n,r){var e=y(r);D({type:"ADD_BY_ID_RECURSIVELY",payload:{ids:n,options:e}})}),[D]),S=t.useCallback((function(n){D({type:"REMOVE_BY_ID_RECURSIVELY",payload:{ids:n}})}),[D]),R=t.useCallback((function(n,t){var u,a,l=y(t),d=o(e.nodes,n),s=[d].concat(r(i(null==d?void 0:d.nodes))).map((function(n){return n.id}));l.isPartialToAll||(u=s,a=_.ids,u.every((function(n){return!a.includes(n)}))?O(s,l):S(s)),l.isPartialToAll&&(c(s,_.ids)?S(s):O(s,l)),g.current.lastToggledId=n,g.current.currentShiftIds=[]}),[e.nodes,_.ids,O,S]),B=t.useCallback((function(n){D({type:"ADD_BY_ID_EXCLUSIVELY",payload:{id:n}})}),[D]),L=t.useCallback((function(){D({type:"REMOVE_BY_ID_EXCLUSIVELY"})}),[D]),T=t.useCallback((function(n){n===_.id?L():B(n),g.current.lastToggledId=n,g.current.currentShiftIds=[]}),[_,L,B]),Y=t.useCallback((function(n){D({type:"ADD_ALL",payload:{ids:n}})}),[D]),h=t.useCallback((function(){D({type:"REMOVE_ALL"})}),[D]),j=t.useCallback((function(n){var r=y(n),t=i(e.nodes).map((function(n){return n.id}));r.isPartialToAll||(v?Y(t):h()),r.isPartialToAll&&(b?h():Y(t))}),[e.nodes,v,Y,h,b]),V=t.useCallback((function(n,r,t){var o=y(r);g.current.currentShiftIds.length&&(S(g.current.currentShiftIds),g.current.currentShiftIds=[]);var i=g.current.lastToggledId,u=n,a=t(e.nodes).map((function(n){return n.id})),c=a.findIndex((function(n){return n===i})),l=a.findIndex((function(n){return n===u}));if(c>l){var d=[l,c];c=d[0],l=d[1]}var s=a.slice(c,l+1);O(s,o),g.current.currentShiftIds=s}),[e.nodes,O,S]);a(l,_,(function(){return D({type:"SET",payload:l})}));var k=t.useMemo((function(){return{onAddById:m,onRemoveById:A,onToggleById:C,onAddByIdRecursively:O,onRemoveByIdRecursively:S,onToggleByIdRecursively:R,onAddByIdExclusively:B,onRemoveByIdExclusively:L,onToggleByIdExclusively:T,onToggleByIdShift:V,onAddAll:Y,onRemoveAll:h,onToggleAll:j}}),[Y,m,O,h,A,S,B,L,T,j,C,R,V]);return[d(d({},_),{},{none:v,all:b}),k]};export{p as u};
//# sourceMappingURL=index-e21c23fe.js.map
