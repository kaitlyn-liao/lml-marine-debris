"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),e=require("react-dom");function o(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,r)}return o}function r(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,o){return e&&a(t.prototype,e),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),t}function s(t,e,o){return e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o,t}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function u(t){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t,e){if(null==t)return{};var o,r,n=function(t,e){if(null==t)return{};var o,r,n={},a=Object.keys(t);for(r=0;r<a.length;r++)o=a[r],e.indexOf(o)>=0||(n[o]=t[o]);return n}(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)o=a[r],e.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(t,o)&&(n[o]=t[o])}return n}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}function d(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var o,r=u(t);if(e){var n=u(this).constructor;o=Reflect.construct(r,arguments,n)}else o=r.apply(this,arguments);return f(this,o)}}function m(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null==o)return;var r,n,a=[],i=!0,s=!1;try{for(o=o.call(t);!(i=(r=o.next()).done)&&(a.push(r.value),!e||a.length!==e);i=!0);}catch(t){s=!0,n=t}finally{try{i||null==o.return||o.return()}finally{if(s)throw n}}return a}(t,e)||v(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return g(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||v(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function v(t,e){if(t){if("string"==typeof t)return g(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?g(t,e):void 0}}function g(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,r=new Array(e);o<e;o++)r[o]=t[o];return r}var _=t.createContext(null),b=!("[object process]"===Object.prototype.toString.call(global.process)&&!global.process.browser)?require("mapbox-gl"):null,w=["resize","remove","mousedown","mouseup","mouseover","mousemove","click","dblclick","mouseenter","mouseleave","mouseout","contextmenu","touchstart","touchend","touchmove","touchcancel","movestart","move","moveend","dragstart","drag","dragend","zoomstart","zoom","zoomend","rotatestart","rotate","rotateend","pitchstart","pitch","pitchend","boxzoomstart","boxzoomend","boxzoomcancel","webglcontextlost","webglcontextrestored","load","error","data","styledata","sourcedata","dataloading","styledataloading","sourcedataloading"];var k=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},C=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t.length!==e.length)return!1;for(var o=0;o<t.length;o+=1)if(t[o]!==e[o])return!1;return!0},x=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=new Set([].concat(y(Object.keys(t)),y(Object.keys(e))));return y(o).reduce((function(o,r){var n=t[r];return n!==e[r]&&o.push([r,n]),o}),[])},S=function(t,e,o,r){var n={layers:[e]};if(r){var a=[[o[0]-r,o[1]-r],[o[0]+r,o[1]+r]];return t.queryRenderedFeatures(a,n)}return t.queryRenderedFeatures(o,n)},L=["before","radius","onClick","onHover","onEnter","onLeave","onContextMenu"],T=["id","before","onClick"],O=[["onClick","click"],["onHover","mousemove"],["onEnter","mouseenter"],["onLeave","mouseleave"],["onContextMenu","contextmenu"]],E=function(e){l(a,t.PureComponent);var o=d(a);function a(t){var e;return n(this,a),s(h(e=o.call(this,t)),"$key",void 0),s(h(e),"$value",void 0),s(h(e),"_id",void 0),s(h(e),"_map",void 0),s(h(e),"_onClick",void 0),s(h(e),"_onHover",void 0),s(h(e),"_onEnter",void 0),s(h(e),"_onLeave",void 0),s(h(e),"_onContextMenu",void 0),s(h(e),"_addLayer",(function(t){var o=e._map,r=t.before;t.radius,t.onClick,t.onHover,t.onEnter,t.onLeave,t.onContextMenu;var n=c(t,L);r&&o.getLayer(r)?o.addLayer(n,r):o.addLayer(n),e._addEventListeners(t)})),s(h(e),"_addEventListeners",(function(t){O.forEach((function(o){var r=m(o,2),n=r[0],a=r[1],i="_".concat(n);t[n]&&e._map.on(a,e._id,e[i])}))})),s(h(e),"_updateEventListeners",(function(t,o){O.forEach((function(r){var n=m(r,2),a=n[0],i=n[1],s="_".concat(a);!o[a]&&t[a]&&e._map.off(i,e._id,e[s]),o[a]&&!t[a]&&e._map.on(i,e._id,e[s])}))})),s(h(e),"_removeEventListeners",(function(t){O.forEach((function(o){var r=m(o,2),n=r[0],a=r[1],i="_".concat(n);t[n]&&e._map.off(a,e._id,e[i])}))})),s(h(e),"_onClick",(function(t){var o=[t.point.x,t.point.y],n=S(e._map,e._id,o,e.props.radius);e.props.onClick(r(r({},t),{},{features:n}))})),s(h(e),"_onHover",(function(t){var o=[t.point.x,t.point.y],n=S(e._map,e._id,o,e.props.radius);e.props.onHover(r(r({},t),{},{features:n}))})),s(h(e),"_onEnter",(function(t){var o=[t.point.x,t.point.y],n=S(e._map,e._id,o,e.props.radius);e.props.onEnter(r(r({},t),{},{features:n}))})),s(h(e),"_onLeave",(function(t){var o=[t.point.x,t.point.y],n=S(e._map,e._id,o,e.props.radius);e.props.onLeave(r(r({},t),{},{features:n}))})),s(h(e),"_onContextMenu",(function(t){var o=[t.point.x,t.point.y],n=S(e._map,e._id,o,e.props.radius);e.props.onContextMenu(r(r({},t),{},{features:n}))})),e._id=t.id,e}return i(a,[{key:"componentDidMount",value:function(){this._addLayer(this.props)}},{key:"componentDidUpdate",value:function(t){var e=this,o=this._map,r=this.props,n=r.id,a=r.before;r.onClick;var i=c(r,T);if(n!==t.id||this.props.type!==t.type||"background"!==t.type&&(this.props.source!==t.source||this.props["source-layer"]!==t["source-layer"]))return this._id=n,this._map.removeLayer(t.id),void this._addLayer(this.props);a!==t.before&&a&&o.getLayer(a)&&o.moveLayer(this._id,a),i.paint!==t.paint&&x(i.paint,t.paint).forEach((function(t){var r=m(t,2),n=r[0],a=r[1];o.setPaintProperty(e._id,n,a)})),i.layout!==t.layout&&x(i.layout,t.layout).forEach((function(t){var r=m(t,2),n=r[0],a=r[1];o.setLayoutProperty(e._id,n,a)})),i.filter!==t.filter&&(i.filter?o.setFilter(this._id,i.filter):o.setFilter(this._id,void 0)),this._updateEventListeners(t,this.props)}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&(this._removeEventListeners(this.props),this._map.getLayer(this._id)&&this._map.removeLayer(this._id))}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),a}();s(E,"displayName","Layer"),s(E,"defaultProps",{radius:0});var P=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_id",void 0),s(h(t),"_map",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this.props,e=t.layer,o=t.before;o&&this._map.getLayer(o)?this._map.addLayer(e,o):this._map.addLayer(e),this._id=e.id}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.getLayer(this._id)&&this._map.removeLayer(this._id)}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(P,"displayName","CustomLayer");var j=[E,P],D=function(t){return j.includes(t.type)},M=function e(o,r){t.Children.forEach(r,(function(t){t&&(D(t)&&o(t),t.props&&t.props.children&&e(o,t.props.children))}))},A=function(t){var e=[];return M((function(t){t.props.before||e.push(function(t){return t.props.id||t.props.layer.id}(t))}),t),e},U=function(e){l(a,t.PureComponent);var o=d(a);function a(e){var r;return n(this,a),s(h(r=o.call(this,e)),"_map",void 0),s(h(r),"_container",void 0),s(h(r),"state",{loaded:!1}),s(h(r),"_onViewportChange",(function(t){if(t.originalEvent){var e=r._map,o=e.getCenter(),n=o.lng,a={latitude:o.lat,longitude:n,zoom:e.getZoom(),pitch:e.getPitch(),bearing:e.getBearing()};r.props.onViewportChange(a)}})),b&&(b.accessToken=e.accessToken),r._container=t.createRef(),r}return i(a,[{key:"componentDidMount",value:function(){var t=this;if(b){var e=this._container.current,o=new b.Map({container:e,style:this.props.mapStyle,interactive:!!this.props.onViewportChange,center:[this.props.longitude,this.props.latitude],zoom:this.props.zoom,pitch:this.props.pitch,bearing:this.props.bearing,minZoom:this.props.minZoom,maxZoom:this.props.maxZoom,hash:this.props.hash,bearingSnap:this.props.bearingSnap,pitchWithRotate:this.props.pitchWithRotate,attributionControl:this.props.attributionControl,logoPosition:this.props.logoPosition,failIfMajorPerformanceCaveat:this.props.failIfMajorPerformanceCaveat,preserveDrawingBuffer:this.props.preserveDrawingBuffer,antialias:this.props.antialias,refreshExpiredTiles:this.props.refreshExpiredTiles,maxBounds:this.props.maxBounds,bounds:this.props.bounds,scrollZoom:this.props.scrollZoom,boxZoom:this.props.boxZoom,dragRotate:this.props.dragRotate,dragPan:this.props.dragPan,keyboard:this.props.keyboard,doubleClickZoom:this.props.doubleClickZoom,trackResize:this.props.trackResize,renderWorldCopies:this.props.renderWorldCopies,maxTileCacheSize:this.props.maxTileCacheSize,localIdeographFontFamily:this.props.localIdeographFontFamily,transformRequest:this.props.transformRequest,collectResourceTiming:this.props.collectResourceTiming,fadeDuration:this.props.fadeDuration,crossSourceCollisions:this.props.crossSourceCollisions,locale:this.props.locale});this._map=o,o.once("load",(function(){t.setState({loaded:!0},t.props.onLoad)})),this.props.onViewportChange&&(o.on("dragend",this._onViewportChange),o.on("zoomend",this._onViewportChange),o.on("rotateend",this._onViewportChange),o.on("pitchend",this._onViewportChange),o.on("boxzoomend",this._onViewportChange)),w.forEach((function(e){var r="on".concat(k(e)),n=t.props[r];n&&(Array.isArray(n)?o.on.apply(o,[e].concat(y(n))):o.on(e,n))})),this.props.cursorStyle&&(o.getCanvas().style.cursor=this.props.cursorStyle),this.props.showTileBoundaries&&(this._map.showTileBoundaries=this.props.showTileBoundaries)}}},{key:"componentDidUpdate",value:function(t){this._updateMapViewport(t,this.props),this._updateMapStyle(t,this.props),this._updateMapSize(t,this.props),this._updateMapEventListeners(t,this.props),!t.cursorStyle!==this.props.cursorStyle&&(this._map.getCanvas().style.cursor=this.props.cursorStyle),t.showTileBoundaries!==this.props.showTileBoundaries&&(this._map.showTileBoundaries=!!this.props.showTileBoundaries)}},{key:"componentWillUnmount",value:function(){this._map&&this._map.remove()}},{key:"getMap",value:function(){return this._map}},{key:"_updateMapEventListeners",value:function(t,e){var o=this;w.forEach((function(r){var n="on".concat(k(r)),a=t[n],i=e[n];if(!(Array.isArray(a)&&Array.isArray(i)&&C(a,i)||a===i)){var s,l;if(a)if(Array.isArray(a))(s=o._map).off.apply(s,[r].concat(y(a)));else o._map.off(r,a);if(i)if(Array.isArray(i))(l=o._map).on.apply(l,[r].concat(y(i)));else o._map.on(r,i)}}))}},{key:"_updateMapStyle",value:function(t,e){var o=this,r=e.mapStyle,n=t.mapStyle;r!==n&&this.setState({loaded:!1},(function(){o._map.setStyle(r),o._map.once("style.load",(function(){return o.setState({loaded:!0})}))}))}},{key:"_updateMapViewport",value:function(t,e){var o=this._map,n=o.getCenter();if(e.latitude!==t.latitude&&e.latitude!==n.lat||e.longitude!==t.longitude&&e.longitude!==n.lng||e.zoom!==t.zoom&&e.zoom!==o.getZoom()||e.pitch!==t.pitch&&e.pitch!==o.getPitch()||e.bearing!==t.bearing&&e.bearing!==o.getBearing()){var a={center:[e.longitude,e.latitude],zoom:e.zoom,pitch:e.pitch,bearing:e.bearing},i=this.props,s=i.viewportChangeMethod,l=r(r({},i.viewportChangeOptions),a);switch(s){case"flyTo":o.flyTo(l);break;case"jumpTo":o.jumpTo(l);break;case"easeTo":o.easeTo(l);break;default:throw new Error("Unknown viewport change method")}}}},{key:"_updateMapSize",value:function(t,e){((t.style&&t.style.height)!==(e.style&&e.style.height)||(t.style&&t.style.width)!==(e.style&&e.style.width))&&this._map.resize()}},{key:"render",value:function(){var e=this.state.loaded,o=this.props,r=o.className,n=o.style,a=this.props.children?function(e){var o=A(e);return o.shift(),function e(r){return"function"==typeof r?r:t.Children.map(r,(function(r){if(!r)return r;if(D(r)){var n=r.props.before||o.shift();return t.cloneElement(r,{before:n})}return r.props&&r.props.children?t.cloneElement(r,{children:e(r.props.children)}):r}))}(e)}(this.props.children):null;return t.createElement(_.Provider,{value:this._map},t.createElement("div",{ref:this._container,style:n,className:r},e&&a))}}]),a}();s(U,"displayName","MapGL"),s(U,"defaultProps",{children:null,className:null,style:null,mapStyle:"mapbox://styles/mapbox/light-v8",accessToken:null,bearing:0,pitch:0,minZoom:0,maxZoom:22,maxBounds:null,bounds:null,hash:!1,bearingSnap:7,pitchWithRotate:!0,attributionControl:!0,logoPosition:"bottom-left",failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,antialias:!1,refreshExpiredTiles:!0,boxZoom:!0,scrollZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,trackResize:!0,renderWorldCopies:!0,maxTileCacheSize:null,onViewportChange:null,onLoad:null,localIdeographFontFamily:null,transformRequest:null,collectResourceTiming:!1,fadeDuration:300,crossSourceCollisions:!0,locale:null,cursorStyle:null,viewportChangeMethod:"jumpTo",viewportChangeOptions:null});var I=function(t){switch(t.type){case"vector":return r({type:"vector"},t);case"raster":return r({type:"raster"},t);case"raster-dem":return r({type:"raster-dem"},t);case"geojson":return r({type:"geojson"},t);case"video":return r({type:"video"},t);case"image":return r({type:"image"},t);default:throw new Error("Unknown type for '".concat(t.id,"' Source"))}},z=["id","children"],F=["id","children"],R=["id","children"],B=function(e){l(a,t.PureComponent);var o=d(a);function a(){var t;n(this,a);for(var e=arguments.length,i=new Array(e),l=0;l<e;l++)i[l]=arguments[l];return s(h(t=o.call.apply(o,[this].concat(i))),"_map",void 0),s(h(t),"state",{loaded:!1}),s(h(t),"_onSourceData",(function(){t._map.isSourceLoaded(t.props.id)&&(t._map.off("sourcedata",t._onSourceData),t.setState({loaded:!0}))})),s(h(t),"_updateGeoJSONSource",(function(e,o,r){if(r.data!==o.data){var n=t._map.getSource(e);void 0!==n&&n.setData(r.data)}})),s(h(t),"_updateImageSource",(function(e,o,r){if(r.url!==o.url||r.coordinates!==o.coordinates){var n=t._map.getSource(e);void 0!==n&&n.updateImage(r)}})),s(h(t),"_updateTileSource",(function(e,o,n){if(n.url!==o.url||!C(n.tiles,o.tiles)){var a=t._map.getSource(e);a._tileJSONRequest&&a._tileJSONRequest.cancel(),a.url=n.url,a.scheme=n.scheme,a._options=r(r({},a._options),n);var i=t._map.style.sourceCaches[e];i&&i.clearTiles(),a.load()}})),s(h(t),"_removeSource",(function(){var e=t.props.id;if(t._map.getSource(e)){var o=t._map.getStyle().layers;o&&o.forEach((function(o){o.source===e&&t._map.removeLayer(o.id)})),t._map.removeSource(e)}})),t}return i(a,[{key:"componentDidMount",value:function(){var t=this.props,e=t.id;t.children;var o=c(t,z),r=I(o);this._map.addSource(e,r),this._map.on("sourcedata",this._onSourceData)}},{key:"componentDidUpdate",value:function(t){var e=t.id;t.children;var o=c(t,F),r=I(o),n=this.props,a=n.id;n.children;var i=c(n,R),s=I(i);if(a!==e||s.type!==r.type)return this._map.removeSource(e),void this._map.addSource(a,s);"geojson"!==s.type||"geojson"!==r.type?"image"!==s.type||"image"!==r.type?"vector"!==s.type||"vector"!==r.type?"raster"===s.type&&"raster"===r.type&&this._updateTileSource(a,r,s):this._updateTileSource(a,r,s):this._updateImageSource(a,r,s):this._updateGeoJSONSource(a,r,s)}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._removeSource()}},{key:"render",value:function(){var e=this,o=this.state.loaded,r=this.props.children;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),o&&r}))}}]),a}();s(B,"displayName","Source");var W=function(o){l(a,t.PureComponent);var r=d(a);function a(t){var e;return n(this,a),s(h(e=r.call(this,t)),"_map",void 0),s(h(e),"_el",void 0),s(h(e),"_popup",void 0),e._el=document.createElement("div"),e}return i(a,[{key:"componentDidMount",value:function(){var t=this.props,e=t.longitude,o=t.latitude,r=t.offset,n=t.closeButton,a=t.closeOnClick,i=t.onClose,s=t.anchor,l=t.className,u=t.maxWidth;this._popup=new b.Popup({offset:r,closeButton:n,closeOnClick:a,anchor:s,className:l,maxWidth:u}),this._popup.setDOMContent(this._el),this._popup.setLngLat([e,o]).addTo(this._map),i&&this._popup.on("close",i)}},{key:"componentDidUpdate",value:function(t){(t.latitude!==this.props.latitude||t.longitude!==this.props.longitude)&&this._popup.setLngLat([this.props.longitude,this.props.latitude])}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._popup.remove()}},{key:"getPopup",value:function(){return this._popup}},{key:"render",value:function(){var o=this;return t.createElement(_.Consumer,{},(function(t){return t&&(o._map=t),e.createPortal(o.props.children,o._el)}))}}]),a}();s(W,"displayName","Popup"),s(W,"defaultProps",{closeButton:!0,closeOnClick:!0,onClose:null,anchor:null,offset:null,className:null,maxWidth:"240px"});var N=function(o){l(a,t.PureComponent);var r=d(a);function a(t){var e;return n(this,a),s(h(e=r.call(this,t)),"_map",void 0),s(h(e),"_el",void 0),s(h(e),"_marker",void 0),s(h(e),"_onDragEnd",(function(){e.props.onDragEnd(e._marker.getLngLat())})),s(h(e),"_onDragStart",(function(){e.props.onDragStart(e._marker.getLngLat())})),s(h(e),"_onDrag",(function(){e.props.onDrag(e._marker.getLngLat())})),e._el=document.createElement("div"),e}return i(a,[{key:"componentDidMount",value:function(){var t=this.props,e=t.longitude,o=t.latitude,r=t.onClick,n=t.onDragEnd,a=t.onDragStart,i=t.onDrag;this._marker=new b.Marker({element:this._el,anchor:this.props.anchor,draggable:this.props.draggable,offset:this.props.offset,rotation:this.props.rotation,pitchAlignment:this.props.pitchAlignment,rotationAlignment:this.props.rotationAlignment}),this._marker.setLngLat([e,o]).addTo(this._map),r&&this._el.addEventListener("click",r),n&&this._marker.on("dragend",this._onDragEnd),a&&this._marker.on("dragstart",this._onDragStart),i&&this._marker.on("drag",this._onDrag)}},{key:"componentDidUpdate",value:function(t){(t.latitude!==this.props.latitude||t.longitude!==this.props.longitude)&&this._marker.setLngLat([this.props.longitude,this.props.latitude])}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&(this.props.onClick&&this._el.removeEventListener("click",this.props.onClick),this._marker.remove())}},{key:"getMarker",value:function(){return this._marker}},{key:"render",value:function(){var o=this;return t.createElement(_.Consumer,{},(function(t){return t&&(o._map=t),e.createPortal(o.props.children,o._el)}))}}]),a}();s(N,"displayName","Marker"),s(N,"defaultProps",{anchor:"center",offset:null,draggable:!1,rotation:0,pitchAlignment:"auto",rotationAlignment:"auto"});var Z=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.id,r=e.source,n=e.sourceLayer,a=e.state;t.setFeatureState({id:o,source:r,sourceLayer:n},a)}},{key:"componentDidUpdate",value:function(t){var e=this._map,o=this.props,r=o.id,n=o.source,a=o.sourceLayer,i=o.state;r===t.id&&n===t.source&&a===t.sourceLayer&&i===t.state||(e.removeFeatureState({id:t.id,source:t.source,sourceLayer:t.sourceLayer}),e.setFeatureState({id:r,source:n,sourceLayer:a},i))}},{key:"componentWillUnmount",value:function(){if(this._map&&this._map.getStyle()){var t=this.props,e=t.id,o=t.source,r=t.sourceLayer;this._map.removeFeatureState({id:e,source:o,sourceLayer:r})}}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}(),V=function(e){l(r,t.PureComponent);var o=d(r);function r(t){var e;return n(this,r),s(h(e=o.call(this,t)),"_map",void 0),s(h(e),"_id",void 0),s(h(e),"_loadImage",(function(t,o){"string"!=typeof t?o(t):e._map.loadImage(t,(function(t,e){if(t)throw t;o(e)}))})),e._id=t.id,e}return i(r,[{key:"componentDidMount",value:function(){var t=this,e=this.props,o=e.image,r=e.pixelRatio,n=e.sdf;this._loadImage(o,(function(e){return t._map.addImage(t._id,e,{pixelRatio:r,sdf:n})}))}},{key:"componentDidUpdate",value:function(t){var e=this,o=this.props,r=o.id,n=o.image,a=o.pixelRatio,i=o.sdf;if(r!==t.id||i!==t.sdf||a!==t.pixelRatio)return this._id=r,this._map.removeImage(t.id),void this._loadImage(n,(function(t){return e._map.addImage(e._id,t,{pixelRatio:a,sdf:i})}));n!==t.image&&this._loadImage(n,(function(t){return e._map.updateImage(e._id,t)}))}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.hasImage(this._id)&&this._map.removeImage(this._id)}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(V,"defaultProps",{pixelRatio:1,sdf:!1});var q=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.compact,r=e.customAttribution,n=e.position,a=new b.AttributionControl({compact:o,customAttribution:r});t.addControl(a,n),this._control=a}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(q,"defaultProps",{position:"bottom-right"});var $=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.container,r=e.position,n=new b.FullscreenControl({container:o});t.addControl(n,r),this._control=n}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s($,"defaultProps",{position:"top-right"});var H=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.positionOptions,r=e.fitBoundsOptions,n=e.trackUserLocation,a=e.showUserLocation,i=e.position,s=e.onTrackUserLocationEnd,l=e.onTrackUserLocationStart,u=e.onError,p=e.onGeolocate,c=new b.GeolocateControl({positionOptions:o,fitBoundsOptions:r,trackUserLocation:n,showUserLocation:a});s&&c.on("trackuserlocationend",s),l&&c.on("trackuserlocationstart",l),u&&c.on("error",u),p&&c.on("geolocate",p),t.addControl(c,i),this._control=c}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(H,"defaultProps",{positionOptions:{enableHighAccuracy:!1,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showUserLocation:!0});var G=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.showCompass,r=e.showZoom,n=e.visualizePitch,a=e.position,i=new b.NavigationControl({showCompass:o,showZoom:r,visualizePitch:n});t.addControl(i,a),this._control=i}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(G,"defaultProps",{showCompass:!0,showZoom:!0,visualizePitch:!1,position:"top-right"});var J=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.maxWidth,r=e.unit,n=e.position,a=new b.ScaleControl({maxWidth:o,unit:r});t.addControl(a,n),this._control=a}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();function K(t,e){return t(e={exports:{}},e.exports),e.exports}s(J,"defaultProps",{position:"bottom-right",unit:"metric"});var Q=K((function(t){function e(t){if(t=Object.assign({},t),!(this instanceof e))throw new Error("MapboxLanguage needs to be called with the new keyword");this.setLanguage=this.setLanguage.bind(this),this._initialStyleUpdate=this._initialStyleUpdate.bind(this),this._defaultLanguage=t.defaultLanguage,this._isLanguageField=t.languageField||/^\{name/,this._getLanguageField=t.getLanguageField||function(t){return"mul"===t?"{name}":"{name_"+t+"}"},this._languageSource=t.languageSource||null,this._languageTransform=t.languageTransform||function(t,e){return"ar"===e?function(t){var e=t.layers.map((function(t){if(!(t.layout||{})["text-field"])return t;var e=0;return Object.assign({},t,{layout:Object.assign({},t.layout,{"text-letter-spacing":e})})}));return Object.assign({},t,{layers:e})}(t):function(t){var e=t.layers.map((function(t){if(!(t.layout||{})["text-field"])return t;var e=0;return"state_label"===t["source-layer"]&&(e=.15),"marine_label"===t["source-layer"]&&(/-lg/.test(t.id)&&(e=.25),/-md/.test(t.id)&&(e=.15),/-sm/.test(t.id)&&(e=.1)),"place_label"===t["source-layer"]&&(/-suburb/.test(t.id)&&(e=.15),/-neighbour/.test(t.id)&&(e=.1),/-islet/.test(t.id)&&(e=.01)),"airport_label"===t["source-layer"]&&(e=.01),"rail_station_label"===t["source-layer"]&&(e=.01),"poi_label"===t["source-layer"]&&/-scalerank/.test(t.id)&&(e=.01),"road_label"===t["source-layer"]&&(/-label-/.test(t.id)&&(e=.01),/-shields/.test(t.id)&&(e=.05)),Object.assign({},t,{layout:Object.assign({},t.layout,{"text-letter-spacing":e})})}));return Object.assign({},t,{layers:e})}(t)},this._excludedLayerIds=t.excludedLayerIds||[],this.supportedLanguages=t.supportedLanguages||["ar","en","es","fr","de","ja","ko","mul","pt","ru","zh"]}function o(t,e,o){if(function(t,e){return"string"==typeof e&&t.test(e)}(t,e))return o;if(function(t,e){return e.stops&&e.stops.filter((function(e){return t.test(e[1])})).length>0}(t,e)){var r=e.stops.map((function(e){return t.test(e[1])?[e[0],o]:e}));return Object.assign({},e,{stops:r})}return e}e.prototype.setLanguage=function(t,e){if(this.supportedLanguages.indexOf(e)<0)throw new Error("Language "+e+" is not supported");var r=this._languageSource||function(t){return Object.keys(t.sources).filter((function(e){var o=t.sources[e];return/mapbox-streets-v\d/.test(o.url)}))[0]}(t);if(!r)return t;var n=this._getLanguageField(e),a=this._isLanguageField,i=this._excludedLayerIds,s=t.layers.map((function(t){return t.source===r?function(t,e,r,n){return e.layout&&e.layout["text-field"]&&-1===n.indexOf(e.id)?Object.assign({},e,{layout:Object.assign({},e.layout,{"text-field":o(t,e.layout["text-field"],r)})}):e}(a,t,n,i):t})),l=Object.assign({},t,{layers:s});return this._languageTransform(l,e)},e.prototype._initialStyleUpdate=function(){var t=this._map.getStyle(),e=this._defaultLanguage||function(t){var e=navigator.languages?navigator.languages[0]:navigator.language||navigator.userLanguage,o=e.split("-"),r=e;o.length>1&&(r=o[0]);if(t.indexOf(r)>-1)return r;return null}(this.supportedLanguages);this._map.off("styledata",this._initialStyleUpdate),this._map.setStyle(this.setLanguage(t,e))},e.prototype.onAdd=function(t){return this._map=t,this._map.on("styledata",this._initialStyleUpdate),this._container=document.createElement("div"),this._container},e.prototype.onRemove=function(){this._map.off("styledata",this._initialStyleUpdate),this._map=void 0},t.exports=e})),X=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),s(h(t),"_setLanguage",(function(){var e=t.props.language,o=t._map,r=t._control;e&&o.setStyle(r.setLanguage(o.getStyle(),e))})),t}return i(r,[{key:"componentDidMount",value:function(){var t=this._map,e=this.props,o=e.supportedLanguages,r=e.languageTransform,n=e.languageField,a=e.getLanguageField,i=e.languageSource,s=e.defaultLanguage,l=new Q({supportedLanguages:o,languageTransform:r,languageField:n,getLanguageField:a,languageSource:i,defaultLanguage:s});t.addControl(l),this._control=l}},{key:"componentDidUpdate",value:function(t){t.language!==this.props.language&&this._setLanguage()}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(X,"defaultProps",{});var Y=K((function(t){var e=[{id:"traffic-street-link-bg",type:"line",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},source:"mapbox://mapbox.mapbox-traffic-v1","source-layer":"traffic",minzoom:15,filter:["all",["==","$type","LineString"],["all",["has","congestion"],["in","class","link","motorway_link","service","street"]]],layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-width":{base:1.5,stops:[[14,2.5],[20,15.5]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(145, 95%, 30%)"],["moderate","hsl(30, 100%, 42%)"],["heavy","hsl(355, 100%, 37%)"],["severe","hsl(355, 70%, 22%)"]]},"line-offset":{base:1.5,stops:[[14,2],[20,18]]},"line-opacity":{base:1,stops:[[15,0],[16,1]]}}},{id:"traffic-secondary-tertiary-bg",type:"line",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},source:"mapbox://mapbox.mapbox-traffic-v1","source-layer":"traffic",minzoom:6,filter:["all",["==","$type","LineString"],["all",["has","congestion"],["in","class","secondary","tertiary"]]],layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-width":{base:1.5,stops:[[9,1.5],[18,11],[20,16.5]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(145, 95%, 30%)"],["moderate","hsl(30, 100%, 42%)"],["heavy","hsl(355, 100%, 37%)"],["severe","hsl(355, 70%, 22%)"]]},"line-offset":{base:1.5,stops:[[10,.5],[15,5],[18,11],[20,14.5]]},"line-opacity":{base:1,stops:[[13,0],[14,1]]}}},{id:"traffic-primary-bg",type:"line",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},source:"mapbox://mapbox.mapbox-traffic-v1","source-layer":"traffic",minzoom:6,filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["has","congestion"]]],layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-width":{base:1.5,stops:[[10,.75],[15,6],[20,18]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(145, 95%, 30%)"],["moderate","hsl(30, 100%, 42%)"],["heavy","hsl(355, 100%, 37%)"],["severe","hsl(355, 70%, 22%)"]]},"line-offset":{base:1.2,stops:[[10,0],[12,1.5],[18,13],[20,16]]},"line-opacity":{base:1,stops:[[11,0],[12,1]]}}},{id:"traffic-trunk-bg",type:"line",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},source:"mapbox://mapbox.mapbox-traffic-v1","source-layer":"traffic",minzoom:6,filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["has","congestion"]]],layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-width":{base:1.5,stops:[[8,.5],[9,2.25],[18,13],[20,17.5]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(145, 95%, 30%)"],["moderate","hsl(30, 100%, 42%)"],["heavy","hsl(355, 100%, 37%)"],["severe","hsl(355, 70%, 22%)"]]},"line-offset":{base:1.5,stops:[[7,0],[9,1],[18,13],[20,18]]},"line-opacity":1}},{id:"traffic-motorway-bg",type:"line",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},source:"mapbox://mapbox.mapbox-traffic-v1","source-layer":"traffic",minzoom:6,filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["has","congestion"]]],layout:{visibility:"visible","line-join":"round","line-cap":"round"},paint:{"line-width":{base:1.5,stops:[[6,.5],[9,3],[18,16],[20,20]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(145, 95%, 30%)"],["moderate","hsl(30, 100%, 42%)"],["heavy","hsl(355, 100%, 37%)"],["severe","hsl(355, 70%, 22%)"]]},"line-opacity":1,"line-offset":{base:1.5,stops:[[7,0],[9,1.2],[11,1.2],[18,10],[20,15.5]]}}},{id:"traffic-primary",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},ref:"traffic-primary-bg",paint:{"line-width":{base:1.5,stops:[[10,1],[15,4],[20,16]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(142, 55%, 50%)"],["moderate","hsl(30, 100%, 55%)"],["heavy","hsl(355, 100%, 50%)"],["severe","hsl(355, 70%, 35%)"]]},"line-offset":{base:1.2,stops:[[10,0],[12,1.5],[18,13],[20,16]]},"line-opacity":1}},{id:"traffic-secondary-tertiary",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},ref:"traffic-secondary-tertiary-bg",paint:{"line-width":{base:1.5,stops:[[9,.5],[18,9],[20,14]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(142, 55%, 50%)"],["moderate","hsl(30, 100%, 55%)"],["heavy","hsl(355, 100%, 50%)"],["severe","hsl(355, 70%, 35%)"]]},"line-offset":{base:1.5,stops:[[10,.5],[15,5],[18,11],[20,14.5]]},"line-opacity":1}},{id:"traffic-street-link",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},ref:"traffic-street-link-bg",paint:{"line-width":{base:1.5,stops:[[14,1.5],[20,13.5]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(142, 55%, 50%)"],["moderate","hsl(30, 100%, 55%)"],["heavy","hsl(355, 100%, 50%)"],["severe","hsl(355, 70%, 35%)"]]},"line-offset":{base:1.5,stops:[[14,2],[20,18]]},"line-opacity":1}},{id:"traffic-trunk",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},ref:"traffic-trunk-bg",paint:{"line-width":{base:1.5,stops:[[8,.75],[18,11],[20,15]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(142, 55%, 50%)"],["moderate","hsl(30, 100%, 55%)"],["heavy","hsl(355, 100%, 50%)"],["severe","hsl(355, 70%, 35%)"]]},"line-offset":{base:1.5,stops:[[7,0],[9,1],[18,13],[20,18]]},"line-opacity":1}},{id:"traffic-motorway",metadata:{"mapbox:group":"4053de47c16e55481b10fd748eaa994c"},ref:"traffic-motorway-bg",paint:{"line-width":{base:1.5,stops:[[6,.5],[9,1.5],[18,14],[20,18]]},"line-color":{base:1,type:"categorical",property:"congestion",stops:[["low","hsl(142, 55%, 50%)"],["moderate","hsl(30, 100%, 55%)"],["heavy","hsl(355, 100%, 50%)"],["severe","hsl(355, 70%, 35%)"]]},"line-opacity":1,"line-offset":{base:1.5,stops:[[7,0],[9,1.2],[11,1.2],[18,10],[20,15.5]]}}}];function o(t){if(!(this instanceof o))throw new Error("MapboxTraffic needs to be called with the new keyword");this.options=Object.assign({showTraffic:!1,showTrafficButton:!0,trafficSource:/mapbox-traffic-v\d/},t),this.render=this.render.bind(this),this.toggleTraffic=this.toggleTraffic.bind(this),this._hideTraffic=this._hideTraffic.bind(this),this._showTraffic=this._showTraffic.bind(this),this._hasTraffic=this._hasTraffic.bind(this),this._toggle=new r({show:this.options.showTrafficButton,onToggle:this.toggleTraffic.bind(this)})}function r(t){var e;t=Object.assign({show:!0,onToggle:function(){}},t),this._btn=((e=document.createElement("button")).className="mapboxgl-ctrl-icon mapboxgl-ctrl-traffic",e.type="button",e["aria-label"]="Inspect",e),this._btn.onclick=t.onToggle,this.elem=function(t,e){var o=document.createElement("div");return o.className="mapboxgl-ctrl mapboxgl-ctrl-group",o.appendChild(t),e||(o.style.display="none"),o}(this._btn,t.show)}o.prototype._hasTraffic=function(){var t=this._map.getStyle(),e=this.options.trafficSource;return Object.keys(t.sources).filter((function(t){return e.test(t)})).length>0},o.prototype.toggleTraffic=function(){this.options.showTraffic=!this.options.showTraffic,this.render()},o.prototype.render=function(){if(!this._hasTraffic()){this._map.addSource("mapbox://mapbox.mapbox-traffic-v1",{type:"vector",url:"mapbox://mapbox.mapbox-traffic-v1"});var t=this._map.getStyle().layers.filter((function(t){return"road"===t["source-layer"]})),o=t[t.length-1].id,r=function(t,e,o){for(var r=0;r<t.layers.length;r++)if(o===t.layers[r].id){var n=t.layers.slice(0,r).concat(e).concat(t.layers.slice(r));return Object.assign({},t,{layers:n})}return t}(this._map.getStyle(),e,o);this._map.setStyle(r)}this.options.showTraffic?(this._showTraffic(),this._toggle.setMapIcon()):(this._hideTraffic(),this._toggle.setTrafficIcon())},o.prototype._hideTraffic=function(){var t=this._map.getStyle(),e=this.options.trafficSource;t.layers.forEach((function(t){e.test(t.source)&&(t.layout=t.layout||{},t.layout.visibility="none")})),this._map.setStyle(t)},o.prototype._showTraffic=function(){var t=this._map.getStyle(),e=this.options.trafficSource;t.layers.forEach((function(t){e.test(t.source)&&(t.layout=t.layout||{},t.layout.visibility="visible")})),this._map.setStyle(t)},o.prototype.onAdd=function(t){return this._map=t,t.on("load",this.render),this._toggle.elem},o.prototype.onRemove=function(){this._map.off("load",this.render);var t=this._toggle.elem;t.parentNode.removeChild(t),this._map=void 0},r.prototype.setTrafficIcon=function(){this._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-traffic"},r.prototype.setMapIcon=function(){this._btn.className="mapboxgl-ctrl-icon mapboxgl-ctrl-map"},t.exports=o})),tt=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),s(h(t),"_control",void 0),s(h(t),"_addControl",(function(){var e=t.props,o=e.showTraffic,r=e.showTrafficButton,n=e.trafficSource,a=new Y({showTraffic:o,showTrafficButton:r,trafficSource:n});t._map.addControl(a),t._control=a})),t}return i(r,[{key:"componentDidMount",value:function(){this._addControl()}},{key:"componentDidUpdate",value:function(t){t.showTraffic!==this.props.showTraffic&&this._control.toggleTraffic(),(t.showTrafficButton!==this.props.showTrafficButton||t.trafficSource!==this.props.trafficSource)&&(this._map.removeControl(this._control),this._addControl())}},{key:"componentWillUnmount",value:function(){this._map&&this._map.getStyle()&&this._map.removeControl(this._control)}},{key:"getControl",value:function(){return this._control}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(tt,"defaultProps",{showTraffic:!1,showTrafficButton:!0,trafficSource:/mapbox-traffic-v\d/});var et=function(e){l(r,t.PureComponent);var o=d(r);function r(){var t;n(this,r);for(var e=arguments.length,a=new Array(e),i=0;i<e;i++)a[i]=arguments[i];return s(h(t=o.call.apply(o,[this].concat(a))),"_map",void 0),t}return i(r,[{key:"componentDidMount",value:function(){this._setFilter()}},{key:"componentDidUpdate",value:function(t){var e=t.filter,o=t.validate,r=this.props,n=r.filter,a=r.validate;(!C(e,n)||o!==a)&&this._setFilter()}},{key:"componentWillUnmount",value:function(){if(this._map&&this._map.getStyle()){var t=this.props.layerId;void 0!==this._map.getLayer(t)&&this._map.setFilter(t,void 0)}}},{key:"_setFilter",value:function(){var t=this.props,e=t.layerId,o=t.filter,r=t.validate;void 0!==this._map.getLayer(e)&&(Array.isArray(o)?this._map.setFilter(e,o,{validate:r}):this._map.setFilter(e,void 0))}},{key:"render",value:function(){var e=this;return t.createElement(_.Consumer,{},(function(t){return t&&(e._map=t),null}))}}]),r}();s(et,"defaultProps",{validate:!0}),exports.AttributionControl=q,exports.CustomLayer=P,exports.FeatureState=Z,exports.Filter=et,exports.FullscreenControl=$,exports.GeolocateControl=H,exports.Image=V,exports.LanguageControl=X,exports.Layer=E,exports.MapContext=_,exports.Marker=N,exports.NavigationControl=G,exports.Popup=W,exports.ScaleControl=J,exports.Source=B,exports.TrafficControl=tt,exports.default=U;
//# sourceMappingURL=react-map-gl.cjs.js.map
